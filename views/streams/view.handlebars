<div class="row">

  <div class="col-md-12">

    <h1>{{stream.title}}
      <span class="pull-right">
        <a href="/output/{{publicKey}}.json"><img src="https://cdn.sparkfun.com/images/framework/json.png" alt="JSON"></a>
        <!-- <a href="/output/{{publicKey}}.csv"><img src="https://cdn.sparkfun.com/images/framework/icon_spreadsheet_black.png" alt="CSV"></a> -->
      </span>
    </h1>

    <p><strong>Fields:</strong> {{> renderFields stream}}</p>
    <p><strong>Tags:</strong> {{> renderTags stream}}</p>

    <p class="lead">{{{markdown stream.description}}}</p>

    <hr>

    <table class="table table-striped text-center table-hover table-bordered" id="data">
      <thead><tr></tr></thead>
      <tbody></tbody>
    </table>

    <script>

      d3.json('/output/{{publicKey}}.json', function(error, records) {

        records.forEach(function(r) {
          delete r._id;
        });

        var thead = d3.select('thead tr').selectAll('th')
                      .data(d3.keys(records[0]))
                      .enter().append('th').text(function(d){return d});

        var tr = d3.select('tbody').selectAll('tr')
                  .data(records).enter().append('tr');

        var td = tr.selectAll('td')
                  .data(function(d){return d3.values(d)})
                  .enter().append('td')
                  .text(function(d) {return d});

      });

    </script>

  </div>

</div>

